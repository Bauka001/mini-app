import{j as e,c as l,x as R,Z as W,w as Y,R as Z}from"./vendor-ui-CeXOM041.js";import{u as J,a}from"./vendor-react-BHatN85T.js";import{G as K,s as b}from"./GameWrapper-DlsME0o6.js";import"./index-BN-omT0U.js";import"./vendor-utils-IhVzdFhg.js";const Q=({onEnd:g})=>{const _=J(),[o,h]=a.useState("idle"),[r,E]=a.useState("red"),[$,z]=a.useState(0),[c,S]=a.useState(60),[u,w]=a.useState(!1),[M,I]=a.useState("front"),[H,v]=a.useState(0),[q,j]=a.useState([]),N=a.useRef(null),y=a.useRef(null),m=a.useRef(null),k=a.useRef("red"),f=a.useRef("idle"),C=a.useRef(!1),x=a.useRef(0);a.useEffect(()=>{k.current=r,r==="red"?(v(1),setTimeout(()=>v(.5),100)):v(0)},[r]),a.useEffect(()=>{f.current=o},[o]),a.useEffect(()=>{C.current=u},[u]);const O=.15,U=90;a.useEffect(()=>(j([{id:1,number:"218",progress:0,isDead:!1,speed:.16,reactionDelay:150,lane:10},{id:2,number:"067",progress:0,isDead:!1,speed:.14,reactionDelay:80,lane:30},{id:3,number:"001",progress:0,isDead:!1,speed:.13,reactionDelay:0,lane:50},{id:4,number:"199",progress:0,isDead:!1,speed:.15,reactionDelay:200,lane:70},{id:5,number:"101",progress:0,isDead:!1,speed:.17,reactionDelay:400,lane:90}]),()=>{D()}),[]);const D=()=>{N.current&&clearInterval(N.current),y.current&&clearTimeout(y.current),m.current&&cancelAnimationFrame(m.current)},L=()=>{h("playing"),z(0),S(U),w(!1),E("red"),I("front"),j(t=>t.map(n=>({...n,progress:0,isDead:!1}))),N.current=setInterval(()=>{S(t=>t<=1?(P(),0):t-1)},1e3),setTimeout(()=>{T()},2e3),m.current=requestAnimationFrame(G)},T=()=>{if(f.current==="dead"||f.current==="won")return;const t=k.current==="red";let n=0;if(t){const i=[2e3,3e3,4e3,5e3];n=i[Math.floor(Math.random()*i.length)]+Math.random()*1e3}else n=Math.random()*2e3+1500;y.current=setTimeout(()=>{E(i=>{const d=i==="green"?"red":"green";return I(d==="green"?"back":"front"),x.current=Date.now(),d==="red"?b.playError():b.playClick(),T(),d})},n)},G=()=>{const t=f.current,n=k.current,i=C.current;if(!(t==="dead"||t==="won")){if(t==="playing"){if(i&&n==="red"&&Date.now()-x.current>300){P();return}i&&z(d=>{const s=d+O;return s>=100?(V(),100):s}),j(d=>d.map(s=>{if(s.isDead||s.progress>=100)return s;let p=!1;if(n==="green")Date.now()-x.current>s.reactionDelay&&(p=!0);else if(Date.now()-x.current<s.reactionDelay)p=!0;else if(Math.random()<.002)return{...s,isDead:!0};if(n==="red"&&p&&Date.now()-x.current>300)return{...s,isDead:!0};if(p){const F=s.progress+s.speed;return{...s,progress:F>=100?100:F}}return s}))}m.current=requestAnimationFrame(G)}},P=t=>{h("dead"),D(),b.playError(),navigator.vibrate&&navigator.vibrate([200,100,200])},V=()=>{h("won"),D(),b.playWin();const t=Math.floor(c*5)+50;g(`${c}s left`,t)},A=()=>{o==="playing"&&w(!0)},B=()=>{w(!1)};return e.jsxs("div",{className:"flex flex-col items-center justify-between h-full w-full select-none relative overflow-hidden bg-[#87CEEB]",onMouseDown:A,onMouseUp:B,onTouchStart:A,onTouchEnd:B,children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-blue-300 via-blue-200 to-white z-0"}),e.jsx("div",{className:"absolute top-10 left-10 w-20 h-8 bg-white/60 rounded-full blur-sm animate-pulse"}),e.jsx("div",{className:"absolute top-20 right-20 w-32 h-12 bg-white/50 rounded-full blur-md animate-pulse delay-700"}),e.jsx("div",{className:"absolute bottom-0 w-full h-[40%] bg-[#E6C288] z-0 border-t-4 border-[#C19A6B]",style:{backgroundImage:"radial-gradient(#D2B48C 15%, transparent 16%), radial-gradient(#D2B48C 15%, transparent 16%)",backgroundSize:"20px 20px",backgroundPosition:"0 0, 10px 10px"}}),e.jsx("div",{className:"absolute right-0 top-0 h-full w-24 bg-[#D1D5DB] z-10 shadow-[-10px_0_20px_rgba(0,0,0,0.2)] flex flex-col justify-end pb-[40%]",children:e.jsx("div",{className:"w-full h-full opacity-20",style:{backgroundImage:"linear-gradient(335deg, rgba(0,0,0,0.2) 23px, transparent 23px), linear-gradient(155deg, rgba(0,0,0,0.2) 23px, transparent 23px), linear-gradient(335deg, rgba(0,0,0,0.2) 23px, transparent 23px), linear-gradient(155deg, rgba(0,0,0,0.2) 23px, transparent 23px)",backgroundSize:"58px 58px",backgroundColor:"#e5e5f7"}})}),e.jsx("div",{className:"absolute bottom-0 right-32 w-4 h-[40%] bg-pink-600/80 z-10 shadow-[0_0_15px_rgba(219,39,119,0.5)]"}),e.jsx("div",{className:"absolute inset-0 z-50 pointer-events-none transition-opacity duration-200",style:{background:`radial-gradient(circle, transparent 50%, rgba(255,0,0,${H*.5}) 100%)`,opacity:r==="red"?1:0}}),r==="red"&&e.jsx("div",{className:"absolute top-0 right-20 w-full h-full bg-red-500/10 z-20 origin-right animate-[scan_2s_ease-in-out_infinite] pointer-events-none mix-blend-overlay"}),e.jsx("div",{className:"absolute bottom-[15%] right-8 z-30 transition-transform duration-500",children:e.jsxs("div",{className:l("relative transition-all duration-300 origin-bottom",M==="back"?"scale-x-[-1]":"scale-x-100"),children:[e.jsx("div",{className:"absolute -top-20 left-1/2 -translate-x-1/2 bg-black px-3 py-1 rounded border-2 border-red-500 shadow-[0_0_15px_red] z-30",children:e.jsx("span",{className:"text-red-500 font-mono font-bold text-xl animate-pulse",children:c<10?`0${c}`:c})}),e.jsxs("div",{className:"flex flex-col items-center scale-90",children:[e.jsxs("div",{className:"w-16 h-20 bg-[#F5D0A9] rounded-[2rem] relative shadow-lg z-20",children:[e.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 w-20 h-20 bg-[#1a1a1a] rounded-t-full rounded-b-[1.5rem] z-10",style:{clipPath:"polygon(0 0, 100% 0, 100% 70%, 80% 60%, 50% 70%, 20% 60%, 0 70%)"}}),M==="front"&&e.jsxs("div",{className:"absolute top-8 left-1/2 -translate-x-1/2 w-full h-full z-20 flex flex-col items-center",children:[e.jsxs("div",{className:"flex gap-3 mb-2",children:[e.jsx("div",{className:l("w-2 h-2 bg-black rounded-full",r==="red"&&"bg-red-600 shadow-[0_0_5px_red]")}),e.jsx("div",{className:l("w-2 h-2 bg-black rounded-full",r==="red"&&"bg-red-600 shadow-[0_0_5px_red]")})]}),e.jsx("div",{className:"w-3 h-1 bg-pink-400 rounded-full mt-1"})]})]}),e.jsxs("div",{className:"w-20 h-28 bg-[#FF9F1C] rounded-t-[2rem] rounded-b-xl -mt-3 relative z-10 shadow-xl flex flex-col items-center",children:[e.jsx("div",{className:"w-full h-full bg-[#F7B731] rounded-t-[2rem] opacity-80",style:{clipPath:"polygon(20% 0%, 80% 0%, 100% 100%, 0% 100%)"}}),e.jsx("div",{className:"absolute top-4 w-4 h-4 bg-white rounded-full border border-black/10 shadow-sm"})]})]})]})}),q.map(t=>e.jsx("div",{className:"absolute transition-all duration-100",style:{bottom:`${8+t.lane*.25}%`,left:`${t.progress}%`,zIndex:Math.floor(100-t.lane)},children:t.isDead?e.jsxs("div",{className:"flex flex-col items-center opacity-80 rotate-90 origin-bottom-left transition-all duration-500",children:[e.jsx(R,{className:"text-gray-700 w-6 h-6 animate-bounce"}),e.jsx("div",{className:"w-10 h-16 bg-[#047857] rounded-xl flex items-center justify-center",children:e.jsx("span",{className:"text-white text-[8px] font-bold rotate-180",children:t.number})}),e.jsx("div",{className:"w-12 h-4 bg-red-600/50 rounded-full blur-sm mt-[-10px]"})]}):e.jsxs("div",{className:l("w-8 h-14 bg-[#047857] rounded-md relative shadow-md flex items-center justify-center transform scale-x-[-1] transition-transform",r==="green"&&!t.isDead&&"animate-[bounce_0.5s_infinite]"),children:[e.jsx("div",{className:"absolute top-1 right-0 w-6 h-6 bg-black/80 rounded-full -mr-1"}),e.jsx("div",{className:"text-white font-mono text-[8px] font-bold relative z-10 transform scale-x-[-1]",children:t.number}),e.jsx("div",{className:"absolute top-[40%] -left-1 w-1 h-8 bg-white/20 rounded-full"})," "]})},t.id)),e.jsx("div",{className:"absolute z-40 transition-all duration-75",style:{bottom:"18%",left:`${$}%`,zIndex:100},children:e.jsxs("div",{className:l("w-10 h-16 bg-[#047857] rounded-lg relative shadow-2xl transition-transform border border-white/10 transform scale-x-[-1]",u&&"animate-[bounce_0.4s_infinite]"),children:[e.jsx("div",{className:"absolute -top-5 right-1/2 translate-x-1/2 w-8 h-8 bg-[#e8c39e] rounded-full border border-black/10 shadow-sm"}),e.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 bg-white px-1 py-0.5 rounded shadow-sm text-[#047857] font-mono text-[9px] font-black border border-[#047857] transform scale-x-[-1]",children:"456"}),e.jsx("div",{className:l("absolute top-5 -left-2 w-3 h-8 bg-[#047857] rounded-full origin-top transition-all",u&&"rotate-45")}),e.jsx("div",{className:l("absolute top-5 -right-2 w-3 h-8 bg-[#047857] rounded-full origin-top transition-all",u&&"-rotate-45")}),e.jsx("div",{className:"absolute -top-12 left-1/2 -translate-x-1/2 animate-bounce",children:e.jsx("div",{className:"w-0 h-0 border-l-[6px] border-l-transparent border-r-[6px] border-r-transparent border-t-[8px] border-t-yellow-400"})})]})}),e.jsxs("div",{className:"absolute bottom-0 w-full h-1/3 flex flex-col items-center justify-center z-50 pointer-events-none",children:[o==="idle"&&e.jsxs("div",{className:"bg-black/40 backdrop-blur-md p-6 rounded-3xl pointer-events-auto border border-white/10 text-center animate-in zoom-in",children:[e.jsxs("h1",{className:"text-4xl font-black text-white mb-2 drop-shadow-lg font-mono",children:["RED LIGHT",e.jsx("br",{}),e.jsx("span",{className:"text-green-400",children:"GREEN LIGHT"})]}),e.jsx("p",{className:"text-white/80 mb-6 font-bold text-sm",children:"Hold to run. Release to stop."}),e.jsx("button",{onClick:t=>{t.stopPropagation(),L()},className:"px-12 py-4 bg-[#db2777] text-white font-black text-xl rounded-2xl shadow-[0_4px_0_rgb(157,23,77)] active:translate-y-1 active:shadow-none hover:bg-[#be185d] transition-all",children:"PLAY"})]}),o==="playing"&&e.jsx("div",{className:l("text-white font-black text-2xl drop-shadow-[0_2px_4px_rgba(0,0,0,0.5)] bg-black/30 px-6 py-3 rounded-2xl backdrop-blur-sm transition-all duration-300 border border-white/10",r==="red"?"opacity-100 scale-110 bg-red-600/50 border-red-500":"opacity-80"),children:r==="red"?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"animate-pulse"})," STOP!"]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"text-yellow-400"})," RUN!"]})}),o==="dead"&&e.jsxs("div",{className:"bg-black/90 backdrop-blur-xl p-8 rounded-[32px] flex flex-col items-center pointer-events-auto animate-in zoom-in border-2 border-pink-500/50 shadow-2xl",children:[e.jsx(R,{size:64,className:"text-pink-500 mb-4 animate-bounce"}),e.jsx("h2",{className:"text-4xl font-black text-white mb-2 tracking-tighter",children:"ELIMINATED"}),e.jsx("p",{className:"text-gray-400 mb-8 font-bold text-lg",children:"You moved during Red Light!"}),e.jsxs("div",{className:"flex gap-4 w-full",children:[e.jsxs("button",{onClick:t=>{t.stopPropagation(),_("/")},className:"flex-1 px-6 py-4 bg-white/10 text-white font-bold rounded-2xl flex items-center justify-center gap-2 hover:bg-white/20 transition-colors",children:[e.jsx(Y,{size:20})," Menu"]}),e.jsxs("button",{onClick:t=>{t.stopPropagation(),L()},className:"flex-1 px-6 py-4 bg-pink-600 text-white font-bold rounded-2xl flex items-center justify-center gap-2 hover:bg-pink-500 shadow-lg shadow-pink-600/20",children:[e.jsx(Z,{size:20})," Retry"]})]})]}),o==="won"&&e.jsxs("div",{className:"bg-black/90 backdrop-blur-xl p-8 rounded-[32px] flex flex-col items-center pointer-events-auto animate-in zoom-in border-2 border-green-500/50 shadow-2xl",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ’°"}),e.jsx("h2",{className:"text-4xl font-black text-white mb-2 tracking-tighter text-green-400",children:"SURVIVED"}),e.jsx("p",{className:"text-gray-400 mb-8 font-bold text-lg",children:"You crossed the finish line!"}),e.jsx("button",{onClick:t=>{t.stopPropagation(),_("/")},className:"w-full px-6 py-4 bg-green-600 text-white font-bold rounded-2xl flex items-center justify-center gap-2 hover:bg-green-500 shadow-lg shadow-green-600/20",children:"Claim Rewards"})]})]}),e.jsx("style",{children:`
        @keyframes scan {
          0% { transform: rotate(0deg); opacity: 0; }
          20% { opacity: 1; }
          50% { transform: rotate(-45deg); opacity: 0.5; }
          80% { opacity: 1; }
          100% { transform: rotate(0deg); opacity: 0; }
        }
      `})]})},re=()=>e.jsx(K,{title:"Red Light, Green Light",instructions:"Hold screen to run when GREEN. Release immediately when RED.",children:({onEnd:g})=>e.jsx(Q,{onEnd:g})});export{re as default};

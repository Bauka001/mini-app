import{j as e,T as k,Z as S,c as C}from"./vendor-ui-CeXOM041.js";import{u as _,a as n}from"./vendor-react-BHatN85T.js";import{l as O}from"./vendor-utils-IhVzdFhg.js";const M="http://localhost:3001",T=()=>{const x=_(),[l,f]=n.useState(null),[r,a]=n.useState("lobby"),[i,m]=n.useState(null),[c,h]=n.useState(0),[d,g]=n.useState(0),[j,o]=n.useState(""),[u,w]=n.useState("");n.useEffect(()=>{const t=O(M,{reconnectionAttempts:3,timeout:5e3,autoConnect:!1});return f(t),t.on("connect",()=>{console.log("Connected to server")}),t.on("connect_error",s=>{console.warn("Socket connection error:",s.message),o("Connection failed. Playing offline/demo mode not available yet.")}),t.on("waiting_for_opponent",()=>{a("finding"),o("Searching for opponent...")}),t.on("match_found",s=>{w(s.roomId),o("Match Found! Starting...")}),t.on("game_start",s=>{a("playing"),m(s.question)}),t.on("next_question",s=>{m(s.question),p(s.scores,t.id)}),t.on("game_over",s=>{a("ended"),p(s.scores,t.id)}),t.on("opponent_disconnected",()=>{o("Opponent disconnected. You win!"),a("ended")}),()=>{t.disconnect()}},[]);const p=(t,s)=>{if(!s)return;h(t[s]||0);const b=Object.keys(t).find(y=>y!==s);b&&g(t[b])},N=()=>{l&&(l.emit("find_match"),a("finding"))},v=t=>{l&&u&&l.emit("submit_answer",{roomId:u,answer:t})};if(r==="lobby")return e.jsxs("div",{className:"min-h-screen bg-black text-white flex flex-col items-center justify-center p-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10 pointer-events-none"}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-primary/20 rounded-full blur-[100px]"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[e.jsxs("div",{className:"mb-6 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-primary/50 blur-xl rounded-full animate-pulse"}),e.jsx(k,{size:64,className:"text-primary relative z-10"})]}),e.jsxs("h1",{className:"text-4xl font-black mb-2 uppercase tracking-tighter",children:["Online ",e.jsx("span",{className:"text-primary",children:"Battle"})]}),e.jsx("p",{className:"text-gray-400 mb-8 max-w-xs",children:"Compete against real players in real-time math battles!"}),e.jsxs("button",{onClick:N,className:"w-full max-w-xs py-4 bg-gradient-to-r from-primary to-blue-600 text-white font-black text-xl rounded-2xl shadow-lg shadow-primary/30 hover:scale-105 transition-transform flex items-center justify-center gap-3",children:[e.jsx(S,{size:24,className:"animate-pulse"}),"Find Match"]}),e.jsx("button",{onClick:()=>x(-1),className:"mt-6 text-gray-500 text-sm font-bold",children:"Back to Menu"})]})]});if(r==="finding")return e.jsxs("div",{className:"min-h-screen bg-black text-white flex flex-col items-center justify-center p-6",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mb-6"}),e.jsx("h2",{className:"text-2xl font-bold animate-pulse",children:j}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Waiting for opponent..."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"mt-8 text-red-500 text-sm font-bold",children:"Cancel"})]});if(r==="ended"){const t=c>d;return e.jsxs("div",{className:"min-h-screen bg-black text-white flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("h1",{className:C("text-5xl font-black mb-4",t?"text-green-400":"text-red-400"),children:t?"YOU WON!":"YOU LOST"}),e.jsxs("div",{className:"text-2xl font-bold mb-8",children:[c," - ",d]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-8 py-3 bg-white text-black font-bold rounded-xl",children:"Play Again"}),e.jsx("button",{onClick:()=>x("/"),className:"mt-4 text-gray-500",children:"Home"})]})}return e.jsxs("div",{className:"min-h-screen bg-black text-white p-4 flex flex-col relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 relative z-10",children:[e.jsxs("div",{className:"flex flex-col items-start bg-blue-500/20 p-3 rounded-xl border border-blue-500/50",children:[e.jsx("span",{className:"text-xs text-blue-300 font-bold uppercase",children:"You"}),e.jsx("span",{className:"text-2xl font-black text-white",children:c})]}),e.jsx("div",{className:"text-xl font-black text-gray-600",children:"VS"}),e.jsxs("div",{className:"flex flex-col items-end bg-red-500/20 p-3 rounded-xl border border-red-500/50",children:[e.jsx("span",{className:"text-xs text-red-300 font-bold uppercase",children:"Opponent"}),e.jsx("span",{className:"text-2xl font-black text-white",children:d})]})]}),i&&e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center relative z-10",children:[e.jsx("div",{className:"w-full bg-white/5 backdrop-blur-xl p-8 rounded-3xl border border-white/10 mb-8 text-center shadow-2xl",children:e.jsx("h2",{className:"text-6xl font-black text-white drop-shadow-lg",children:i.text})}),e.jsx("div",{className:"grid grid-cols-2 gap-4 w-full max-w-sm",children:i.options.map((t,s)=>e.jsx("button",{onClick:()=>v(t),className:"py-6 bg-white/10 hover:bg-primary hover:text-black rounded-2xl text-3xl font-bold transition-all active:scale-95 border border-white/5",children:t},s))})]})]})};export{T as BattlePage,T as default};
